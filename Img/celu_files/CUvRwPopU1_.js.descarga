if (self.CavalryLogger) { CavalryLogger.start_js(["LhHDF"]); }

__d("AdsMessagePort",["Promise","abstractMethod","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";var g,h=function(){function a(){this.$1=[]}var b=a.prototype;b.add=function(a){this.$1.push(a);return a};b.remove=function(a){a=this.$1.indexOf(a);if(a>-1){this.$1.splice(a,1);return!0}else return!1};b.call=function(a){if(this.$1.length>0){for(var b=this.$1,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e(a)}return!0}else return!1};return a}();a=function(){function a(a,b,c){var d=this;c===void 0&&(c=!1);this.$1=new Map();this.isRealWorker=!1;this.onUnhandledMessage=new h();this.onMessage=new h();this.onMessageHandler=function(a){d.onMessage.call(a);var b=d.$1.get(a.type);(!b||!b.call(a))&&d.onUnhandledMessage.call(a)};this.$3=a;this.$2=b;this.isRealWorker=c}var c=a.prototype;c.postMessage=function(a){this.$3.postMessage(a)};c.addMessageListener=function(a,b){var c=this.$1.get(a);c||(c=new h(),this.$1.set(a,c));return c.add(b)};c.removeMessageListener=function(a,b){a=this.$1.get(a);return!!a&&a.remove(b)};c.onMessageOnce=function(a,c){var d=this;return new(b("Promise"))(function(b){var e=d.addMessageListener(a,function(f){c(f)&&(d.removeMessageListener(a,e),b(f))})})};c.start=function(a){var c=this;a&&(this.$3=a);this.$3.setMessageHandler?this.$3.setMessageHandler(this.onMessageHandler):this.$3.addEventListener&&this.$3.addEventListener("message",function(a){return c.onMessageHandler(a.data)});var d=this;d.postMessage({type:"endpoint_started",endpoint:this.$2,timestamp:(g||(g=b("performanceAbsoluteNow")))()});d.addMessageListener("endpoint_started",function(a){d.postMessage({type:"endpoint_started_received",endpoint:a.endpoint,targetEndpoint:c.$2,timestamp:(g||(g=b("performanceAbsoluteNow")))()})})};c.close=function(){b("abstractMethod")("AdsMessagePort","close")};return a}();f.AdsMessagePort=a;c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);f.AdsWorkerToMainPort=c;d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);f.AdsMainToWorkerPort=d}),null);
__d("AdsBackgroundWorkerClient",["invariant","AdsBackgroundWebWorkerEntryPointResource","AdsMessagePort","AdsWorkerMgmtQPLLoggerChannel","FBLogger","JSResource","QuickLogActionType","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=b("gkx")("1598383")&&!!Worker&&window.AdsBackgroundWorkerInstance!=void 0;function h(a){return a.startsWith("/")||new RegExp("^(?:https?://"+window.location.host+")?/").test(a)}c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c=window.AdsBackgroundWorkerInstance,d=b("AdsBackgroundWebWorkerEntryPointResource");if(!c){var e=h(d.url)?d.url:window.URL.createObjectURL(new Blob(["importScripts('"+d.url+"');"],{type:"text/javascript"}));c=new Worker(e)}c.onerror=function(a){b("FBLogger")("adsworker").mustfix("Error in worker: "+a)};d.dynamicModules&&c.postMessage({type:"defineModules",args:[d.dynamicModules]});i("WORKER_INIT_JS_RUN",{timestamp:window.AdsBackgroundWorkerInitTime,bothEvents:!0});e=a.call(this,c,"main_thread",!0)||this;e.$AdsWebWorkerPort1=c;return e}var d=c.prototype;d.close=function(){this.$AdsWebWorkerPort1.terminate(),a.prototype.close.call(this)};return c}(b("AdsMessagePort").AdsMainToWorkerPort);d=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d=[],e={postMessage:function(a){d.push(a)}};c=a.call(this,e,"worker_polyfill")||this;b("JSResource")("AdsBackgroundWorkerRootModule").__setRef("AdsBackgroundWorkerClient").load().then(function(a){a.CurrentWorker.start({postMessage:function(a){c.onMessageHandler(a)},setMessageHandler:function(b){b===a.CurrentWorker.onMessageHandler||g(0,23259)}}),e.postMessage=function(b){a.CurrentWorker.onMessageHandler(b)},d.forEach(function(a){return e.postMessage(a)}),d=[]})["catch"](function(a){b("FBLogger")("adsworker").warn("Unhandled message: "+a)});return c}return c}(b("AdsMessagePort").AdsMainToWorkerPort);b("AdsWorkerMgmtQPLLoggerChannel").markerStartFromNavStart(41491663);function i(a,c){b("AdsWorkerMgmtQPLLoggerChannel").addPoint(41491663,a,c==null?void 0:c.timestamp),(c==null?void 0:c.bothEvents)&&b("AdsWorkerMgmtQPLLoggerChannel").addPoint(41484289,"[Worker] "+a,c==null?void 0:c.timestamp)}i("CLIENT_JS_RUN_START",{bothEvents:!0});i("INIT_START");b("AdsWorkerMgmtQPLLoggerChannel").markerAnnotate(41491663,{string:{worker_type:a?"real":"polyfill"}});b("AdsWorkerMgmtQPLLoggerChannel").markerAnnotate(41484289,{string:{worker_type:a?"real":"polyfill"}});f=a?new c():new d();i("FIRST_ROUND_TRIP_START");f.start();b("AdsWorkerMgmtQPLLoggerChannel").setInMessagePort(f);i("INIT_END");f.addMessageListener("endpoint_started",function(a){i("WORKER_JS_RUN_START",{timestamp:a.timestamp,bothEvents:!0}),b("AdsWorkerMgmtQPLLoggerChannel").markerAnnotate(41491663,{string:{endpoint:a.endpoint}})});f.addMessageListener("endpoint_started_received",function(a){i("FIRST_ROUND_TRIP_END"),b("AdsWorkerMgmtQPLLoggerChannel").markerEnd(41491663,b("QuickLogActionType").SUCCESS)});a=f;e.exports=a}),null);
__d("AdsWorkerAPIClientClient",["AdsBackgroundWorkerClient","ApiClient","FBLogger"],(function(a,b,c,d,e,f){"use strict";var g=0,h={};a={graph:function(a,c,d,e,f){var i="request"+g++;h[i]=f;f=b("ApiClient").getDefaultParams();var j=!1;try{b("AdsBackgroundWorkerClient").postMessage({type:"api_client_graph",requestID:i,index:e,accessToken:b("ApiClient").getAccessToken(),clientID:b("ApiClient").getClientID(),path:a,method:c,params:f?babelHelpers["extends"]({},f,d):d}),j=!0}catch(a){b("FBLogger")("adsworker").mustfix("Error sending message to worker: "+a)}return j}};b("AdsBackgroundWorkerClient").addMessageListener("api_client_graph_response",function(a){var b=h[a.requestID];b&&(b(a.response),delete h[a.requestID])});b("AdsBackgroundWorkerClient").addMessageListener("api_client_inform",function(a){var c=a.subscriptionType;a=a.args;b("ApiClient").inform.apply(b("ApiClient"),[c].concat(a))});e.exports=a}),null);